# WalletConnection 组件功能说明

## 新增功能

### 1. 钱包头像展示
- **默认头像**：为每个钱包地址自动生成基于地址的彩色几何头像
- **ENS 头像**：如果钱包有 ENS 域名且设置了头像，会优先显示 ENS 头像
- **头像加载状态**：在获取 ENS 信息时显示加载动画

### 2. ENS 名称和头像支持
- **ENS 域名显示**：连接的钱包如果有 ENS 域名，会显示域名而不是地址
- **双重显示**：有 ENS 域名时，主要显示域名，下方小字显示缩短的钱包地址
- **ENS 头像**：自动获取并显示 ENS 设置的头像图片
- **回退机制**：ENS 头像加载失败时自动回退到默认几何头像

### 3. 钱包切换功能
- **多账户支持**：自动检测 MetaMask 中的所有可用账户
- **下拉菜单**：点击已连接的钱包显示下拉菜单
- **账户列表**：显示最多3个其他可用账户供切换
- **一键切换**：点击其他账户即可切换（需要用户确认）
- **当前账户标识**：清楚标识当前连接的账户

## 技术特性

### UI/UX 改进
- **现代化设计**：采用毛玻璃效果和渐变背景
- **悬停效果**：鼠标悬停时的动画和视觉反馈
- **响应式布局**：在不同屏幕尺寸下都有良好的显示效果
- **加载状态**：连接和切换过程中的加载提示

### 安全性
- **权限请求**：切换账户时会请求用户授权
- **错误处理**：完善的错误处理和用户提示
- **数据验证**：对钱包地址和 ENS 数据进行验证

## 使用方法

### 基本连接
```tsx
<WalletConnection
  account={currentAccount}
  isConnecting={isConnecting}
  onConnect={handleConnect}
  onDisconnect={handleDisconnect}
/>
```

### 主要功能
1. **连接钱包**：点击"连接 MetaMask"按钮
2. **查看信息**：连接后显示 ENS 名称（如有）或钱包地址，以及对应头像
3. **切换账户**：点击已连接的钱包卡片，在下拉菜单中选择其他账户
4. **断开连接**：在下拉菜单中点击"断开连接"

## 文件结构

```
src/
├── components/
│   ├── WalletConnection.tsx    # 主要组件文件
│   └── WalletConnection.css    # 样式文件
├── config/
│   └── text.ts                 # 文本配置（已更新）
└── types/
    └── ethereum.d.ts           # TypeScript 类型定义
```

## 依赖说明

### 现有依赖
- `ethers`：用于与以太坊区块链交互和 ENS 解析
- `react`：React 框架

### 新增功能不需要额外依赖
所有新功能都基于现有的 `ethers` 库实现，无需安装额外的包。

## 注意事项

1. **ENS 支持**：ENS 功能需要连接到支持 ENS 的网络（如以太坊主网）
2. **MetaMask 版本**：建议使用较新版本的 MetaMask 以获得最佳体验
3. **网络兼容性**：在测试网络中 ENS 功能可能受限
4. **性能优化**：ENS 信息会被缓存，避免重复请求

## 自定义样式

可以通过修改 `WalletConnection.css` 文件来自定义样式：

```css
/* 自定义头像颜色 */
.default-avatar {
  /* 修改默认头像样式 */
}

/* 自定义下拉菜单 */
.wallet-dropdown {
  /* 修改下拉菜单样式 */
}
```

## 故障排除

1. **ENS 不显示**：检查网络连接和以太坊网络状态
2. **切换失败**：确保 MetaMask 已解锁且有多个账户
3. **头像不显示**：检查 ENS 头像 URL 是否有效
4. **样式问题**：确保 CSS 文件已正确导入